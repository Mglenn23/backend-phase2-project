'use strict'

const { concat } = require('ramda')
const { commitDivider, lineJoin } = require('../utils')

const prependWithLog = options => concat([ 'git', 'log' ], options)
const getLatestTagCommand = () => ([ 'git', 'describe', '--tags', '--abbrev=0' ])

function logCommand (formatters, tag, date) {
  const opts = (date)
                ? `--since=${date}`
                : (tag)
                  ? `${tag}..HEAD`
                  : ''

  return prependWithLog([ opts, `--pretty=format:${lineJoin(formatters) + commitDivider()}` ])
}

module.exports = {
  log: logCommand,
  latestTag: getLatestTagCommand
}
